{"ast":null,"code":"/**\n    * @license\n    * Copyright 2020 Google LLC. All Rights Reserved.\n    * Licensed under the Apache License, Version 2.0 (the \"License\");\n    * you may not use this file except in compliance with the License.\n    * You may obtain a copy of the License at\n    *\n    * http://www.apache.org/licenses/LICENSE-2.0\n    *\n    * Unless required by applicable law or agreed to in writing, software\n    * distributed under the License is distributed on an \"AS IS\" BASIS,\n    * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n    * See the License for the specific language governing permissions and\n    * limitations under the License.\n    * =============================================================================\n    */\nimport { loadGraphModel as t } from \"@tensorflow/tfjs-converter\";\nimport { image as n, tensor2d as e, tensor1d as r, tidy as o, slice as i, add as s, div as a, mul as u, sub as h, concat2d as d, getBackend as c, env as f, sigmoid as l, reshape as p, util as m, Tensor as v, browser as P } from \"@tensorflow/tfjs-core\";\n\nfunction g(t, n, e, r) {\n  return new (e || (e = Promise))(function (o, i) {\n    function s(t) {\n      try {\n        u(r.next(t));\n      } catch (t) {\n        i(t);\n      }\n    }\n\n    function a(t) {\n      try {\n        u(r.throw(t));\n      } catch (t) {\n        i(t);\n      }\n    }\n\n    function u(t) {\n      var n;\n      t.done ? o(t.value) : (n = t.value, n instanceof e ? n : new e(function (t) {\n        t(n);\n      })).then(s, a);\n    }\n\n    u((r = r.apply(t, n || [])).next());\n  });\n}\n\nfunction b(t, n) {\n  var e,\n      r,\n      o,\n      i,\n      s = {\n    label: 0,\n    sent: function () {\n      if (1 & o[0]) throw o[1];\n      return o[1];\n    },\n    trys: [],\n    ops: []\n  };\n  return i = {\n    next: a(0),\n    throw: a(1),\n    return: a(2)\n  }, \"function\" == typeof Symbol && (i[Symbol.iterator] = function () {\n    return this;\n  }), i;\n\n  function a(i) {\n    return function (a) {\n      return function (i) {\n        if (e) throw new TypeError(\"Generator is already executing.\");\n\n        for (; s;) try {\n          if (e = 1, r && (o = 2 & i[0] ? r.return : i[0] ? r.throw || ((o = r.return) && o.call(r), 0) : r.next) && !(o = o.call(r, i[1])).done) return o;\n\n          switch (r = 0, o && (i = [2 & i[0], o.value]), i[0]) {\n            case 0:\n            case 1:\n              o = i;\n              break;\n\n            case 4:\n              return s.label++, {\n                value: i[1],\n                done: !1\n              };\n\n            case 5:\n              s.label++, r = i[1], i = [0];\n              continue;\n\n            case 7:\n              i = s.ops.pop(), s.trys.pop();\n              continue;\n\n            default:\n              if (!(o = s.trys, (o = o.length > 0 && o[o.length - 1]) || 6 !== i[0] && 2 !== i[0])) {\n                s = 0;\n                continue;\n              }\n\n              if (3 === i[0] && (!o || i[1] > o[0] && i[1] < o[3])) {\n                s.label = i[1];\n                break;\n              }\n\n              if (6 === i[0] && s.label < o[1]) {\n                s.label = o[1], o = i;\n                break;\n              }\n\n              if (o && s.label < o[2]) {\n                s.label = o[2], s.ops.push(i);\n                break;\n              }\n\n              o[2] && s.ops.pop(), s.trys.pop();\n              continue;\n          }\n\n          i = n.call(t, s);\n        } catch (t) {\n          i = [6, t], r = 0;\n        } finally {\n          e = o = 0;\n        }\n\n        if (5 & i[0]) throw i[1];\n        return {\n          value: i[0] ? i[1] : void 0,\n          done: !0\n        };\n      }([i, a]);\n    };\n  }\n}\n\nfunction k(t) {\n  return [Math.abs(t.endPoint[0] - t.startPoint[0]), Math.abs(t.endPoint[1] - t.startPoint[1])];\n}\n\nfunction x(t) {\n  return [t.startPoint[0] + (t.endPoint[0] - t.startPoint[0]) / 2, t.startPoint[1] + (t.endPoint[1] - t.startPoint[1]) / 2];\n}\n\nfunction y(t, n) {\n  void 0 === n && (n = 1.5);\n  var e = x(t),\n      r = k(t),\n      o = [n * r[0] / 2, n * r[1] / 2];\n  return {\n    startPoint: [e[0] - o[0], e[1] - o[1]],\n    endPoint: [e[0] + o[0], e[1] + o[1]],\n    palmLandmarks: t.palmLandmarks\n  };\n}\n\nfunction w(t) {\n  var n = x(t),\n      e = k(t),\n      r = Math.max.apply(Math, e) / 2;\n  return {\n    startPoint: [n[0] - r, n[1] - r],\n    endPoint: [n[0] + r, n[1] + r],\n    palmLandmarks: t.palmLandmarks\n  };\n}\n\nfunction L(t, n) {\n  var e = [t.endPoint[0] - t.startPoint[0], t.endPoint[1] - t.startPoint[1]],\n      r = [e[0] * n[0], e[1] * n[1]];\n  return {\n    startPoint: [t.startPoint[0] + r[0], t.startPoint[1] + r[1]],\n    endPoint: [t.endPoint[0] + r[0], t.endPoint[1] + r[1]],\n    palmLandmarks: t.palmLandmarks\n  };\n}\n\nvar B = function () {\n  function t(t, n, o, i, s, a) {\n    this.model = t, this.width = n, this.height = o, this.iouThreshold = s, this.scoreThreshold = a, this.anchors = i.map(function (t) {\n      return [t.x_center, t.y_center];\n    }), this.anchorsTensor = e(this.anchors), this.inputSizeTensor = r([n, o]), this.doubleInputSizeTensor = r([2 * n, 2 * o]);\n  }\n\n  return t.prototype.normalizeBoxes = function (t) {\n    var n = this;\n    return o(function () {\n      var e = i(t, [0, 0], [-1, 2]),\n          r = i(t, [0, 2], [-1, 2]),\n          o = s(a(e, n.inputSizeTensor), n.anchorsTensor),\n          c = a(r, n.doubleInputSizeTensor),\n          f = u(h(o, c), n.inputSizeTensor),\n          l = u(s(o, c), n.inputSizeTensor);\n      return d([f, l], 1);\n    });\n  }, t.prototype.normalizeLandmarks = function (t, n) {\n    var e = this;\n    return o(function () {\n      var r = s(a(t.reshape([-1, 7, 2]), e.inputSizeTensor), e.anchors[n]);\n      return u(r, e.inputSizeTensor);\n    });\n  }, t.prototype.getBoundingBoxes = function (t) {\n    return g(this, void 0, void 0, function () {\n      var e,\n          r,\n          s,\n          a,\n          d,\n          p,\n          m,\n          v,\n          P,\n          g,\n          k,\n          x,\n          y,\n          w,\n          L,\n          B = this;\n      return b(this, function (b) {\n        switch (b.label) {\n          case 0:\n            return e = o(function () {\n              return u(h(t, .5), 2);\n            }), \"webgl\" === c() ? (s = f().get(\"WEBGL_PACK_DEPTHWISECONV\"), f().set(\"WEBGL_PACK_DEPTHWISECONV\", !0), r = this.model.predict(e), f().set(\"WEBGL_PACK_DEPTHWISECONV\", s)) : r = this.model.predict(e), a = r.squeeze(), d = o(function () {\n              return l(i(a, [0, 0], [-1, 1])).squeeze();\n            }), p = i(a, [0, 1], [-1, 4]), m = this.normalizeBoxes(p), v = console.warn, console.warn = function () {}, P = n.nonMaxSuppression(m, d, 1, this.iouThreshold, this.scoreThreshold), console.warn = v, [4, P.array()];\n\n          case 1:\n            return g = b.sent(), k = [e, r, P, a, m, p, d], 0 === g.length ? (k.forEach(function (t) {\n              return t.dispose();\n            }), [2, null]) : (x = g[0], y = i(m, [x, 0], [1, -1]), w = i(a, [x, 5], [1, 14]), L = o(function () {\n              return B.normalizeLandmarks(w, x).reshape([-1, 2]);\n            }), k.push(w), k.forEach(function (t) {\n              return t.dispose();\n            }), [2, {\n              boxes: y,\n              palmLandmarks: L\n            }]);\n        }\n      });\n    });\n  }, t.prototype.estimateHandBounds = function (t) {\n    return g(this, void 0, void 0, function () {\n      var n,\n          e,\n          r,\n          i,\n          s,\n          a,\n          u,\n          h,\n          d = this;\n      return b(this, function (c) {\n        switch (c.label) {\n          case 0:\n            return n = t.shape[1], e = t.shape[2], r = o(function () {\n              return t.resizeBilinear([d.width, d.height]).div(255);\n            }), [4, this.getBoundingBoxes(r)];\n\n          case 1:\n            return null === (i = c.sent()) ? (r.dispose(), [2, null]) : (s = i.boxes.arraySync(), a = s[0].slice(0, 2), u = s[0].slice(2, 4), h = i.palmLandmarks.arraySync(), r.dispose(), i.boxes.dispose(), i.palmLandmarks.dispose(), [2, (f = {\n              startPoint: a,\n              endPoint: u,\n              palmLandmarks: h\n            }, l = [e / this.width, n / this.height], {\n              startPoint: [f.startPoint[0] * l[0], f.startPoint[1] * l[1]],\n              endPoint: [f.endPoint[0] * l[0], f.endPoint[1] * l[1]],\n              palmLandmarks: f.palmLandmarks.map(function (t) {\n                return [t[0] * l[0], t[1] * l[1]];\n              })\n            })]);\n        }\n\n        var f, l;\n      });\n    });\n  }, t;\n}(),\n    I = {\n  thumb: [1, 2, 3, 4],\n  indexFinger: [5, 6, 7, 8],\n  middleFinger: [9, 10, 11, 12],\n  ringFinger: [13, 14, 15, 16],\n  pinky: [17, 18, 19, 20],\n  palmBase: [0]\n};\n\nfunction C(t, n) {\n  var e,\n      r = Math.PI / 2 - Math.atan2(-(n[1] - t[1]), n[0] - t[0]);\n  return (e = r) - 2 * Math.PI * Math.floor((e + Math.PI) / (2 * Math.PI));\n}\n\nvar H = function (t, n) {\n  return [[1, 0, t], [0, 1, n], [0, 0, 1]];\n};\n\nfunction M(t, n) {\n  for (var e = 0, r = 0; r < t.length; r++) e += t[r] * n[r];\n\n  return e;\n}\n\nfunction T(t, n) {\n  for (var e = [], r = 0; r < t.length; r++) e.push(t[r][n]);\n\n  return e;\n}\n\nfunction E(t, n) {\n  for (var e = [], r = t.length, o = 0; o < r; o++) {\n    e.push([]);\n\n    for (var i = 0; i < r; i++) e[o].push(M(t[o], T(n, i)));\n  }\n\n  return e;\n}\n\nfunction O(t, n) {\n  var e = Math.cos(t),\n      r = Math.sin(t),\n      o = [[e, -r, 0], [r, e, 0], [0, 0, 1]],\n      i = E(H(n[0], n[1]), o);\n  return E(i, H(-n[0], -n[1]));\n}\n\nfunction S(t, n) {\n  return [M(t, n[0]), M(t, n[1])];\n}\n\nvar W = [0, -.4],\n    z = [0, -.1],\n    D = [0, 5, 9, 13, 17, 1, 2],\n    _ = function () {\n  function t(t, n, e, r, o, i) {\n    this.regionsOfInterest = [], this.runsWithoutHandDetector = 0, this.boundingBoxDetector = t, this.meshDetector = n, this.maxContinuousChecks = o, this.detectionConfidence = i, this.meshWidth = e, this.meshHeight = r, this.maxHandsNumber = 1;\n  }\n\n  return t.prototype.getBoxForPalmLandmarks = function (t, n) {\n    var e = t.map(function (t) {\n      return S(t.concat([1]), n);\n    });\n    return y(w(L(this.calculateLandmarksBoundingBox(e), W)), 3);\n  }, t.prototype.getBoxForHandLandmarks = function (t) {\n    for (var n = y(w(L(this.calculateLandmarksBoundingBox(t), z)), 1.65), e = [], r = 0; r < D.length; r++) e.push(t[D[r]].slice(0, 2));\n\n    return n.palmLandmarks = e, n;\n  }, t.prototype.transformRawCoords = function (t, n, e, r) {\n    var o,\n        i,\n        s,\n        a,\n        u = this,\n        h = k(n),\n        d = [h[0] / this.meshWidth, h[1] / this.meshHeight],\n        c = t.map(function (t) {\n      return [d[0] * (t[0] - u.meshWidth / 2), d[1] * (t[1] - u.meshHeight / 2), t[2]];\n    }),\n        f = O(e, [0, 0]),\n        l = c.map(function (t) {\n      return S(t, f).concat([t[2]]);\n    }),\n        p = (i = [[(o = r)[0][0], o[1][0]], [o[0][1], o[1][1]]], s = [o[0][2], o[1][2]], a = [-M(i[0], s), -M(i[1], s)], [i[0].concat(a[0]), i[1].concat(a[1]), [0, 0, 1]]),\n        m = x(n).concat([1]),\n        v = [M(m, p[0]), M(m, p[1])];\n    return l.map(function (t) {\n      return [t[0] + v[0], t[1] + v[1], t[2]];\n    });\n  }, t.prototype.estimateHand = function (t) {\n    return g(this, void 0, void 0, function () {\n      var e, r, o, i, s, a, u, h, d, l, m, v, P, g, k, y, w, L, B, I;\n      return b(this, function (b) {\n        switch (b.label) {\n          case 0:\n            return !0 !== (e = this.shouldUpdateRegionsOfInterest()) ? [3, 2] : [4, this.boundingBoxDetector.estimateHandBounds(t)];\n\n          case 1:\n            return null === (r = b.sent()) ? (t.dispose(), this.regionsOfInterest = [], [2, null]) : (this.updateRegionsOfInterest(r, !0), this.runsWithoutHandDetector = 0, [3, 3]);\n\n          case 2:\n            this.runsWithoutHandDetector++, b.label = 3;\n\n          case 3:\n            return o = this.regionsOfInterest[0], i = C(o.palmLandmarks[0], o.palmLandmarks[2]), s = x(o), a = [s[0] / t.shape[2], s[1] / t.shape[1]], u = n.rotateWithOffset(t, i, 0, a), h = O(-i, s), d = !0 === e ? this.getBoxForPalmLandmarks(o.palmLandmarks, h) : o, l = function (t, e, r) {\n              var o = e.shape[1],\n                  i = e.shape[2],\n                  s = [[t.startPoint[1] / o, t.startPoint[0] / i, t.endPoint[1] / o, t.endPoint[0] / i]];\n              return n.cropAndResize(e, s, [0], r);\n            }(d, u, [this.meshWidth, this.meshHeight]), m = l.div(255), l.dispose(), u.dispose(), \"webgl\" === c() ? (P = f().get(\"WEBGL_PACK_DEPTHWISECONV\"), f().set(\"WEBGL_PACK_DEPTHWISECONV\", !0), v = this.meshDetector.predict(m), f().set(\"WEBGL_PACK_DEPTHWISECONV\", P)) : v = this.meshDetector.predict(m), g = v[0], k = v[1], m.dispose(), y = g.dataSync()[0], g.dispose(), y < this.detectionConfidence ? (k.dispose(), this.regionsOfInterest = [], [2, null]) : (w = p(k, [-1, 3]), L = w.arraySync(), k.dispose(), w.dispose(), B = this.transformRawCoords(L, d, i, h), I = this.getBoxForHandLandmarks(B), this.updateRegionsOfInterest(I, !1), [2, {\n              landmarks: B,\n              handInViewConfidence: y,\n              boundingBox: {\n                topLeft: I.startPoint,\n                bottomRight: I.endPoint\n              }\n            }]);\n        }\n      });\n    });\n  }, t.prototype.calculateLandmarksBoundingBox = function (t) {\n    var n = t.map(function (t) {\n      return t[0];\n    }),\n        e = t.map(function (t) {\n      return t[1];\n    });\n    return {\n      startPoint: [Math.min.apply(Math, n), Math.min.apply(Math, e)],\n      endPoint: [Math.max.apply(Math, n), Math.max.apply(Math, e)]\n    };\n  }, t.prototype.updateRegionsOfInterest = function (t, n) {\n    if (n) this.regionsOfInterest = [t];else {\n      var e = this.regionsOfInterest[0],\n          r = 0;\n\n      if (null != e && null != e.startPoint) {\n        var o = t.startPoint,\n            i = o[0],\n            s = o[1],\n            a = t.endPoint,\n            u = a[0],\n            h = a[1],\n            d = e.startPoint,\n            c = d[0],\n            f = d[1],\n            l = e.endPoint,\n            p = l[0],\n            m = l[1],\n            v = Math.max(i, c),\n            P = Math.max(s, f),\n            g = (Math.min(u, p) - v) * (Math.min(h, m) - P);\n        r = g / ((u - i) * (h - s) + (p - c) * (m - s) - g);\n      }\n\n      this.regionsOfInterest[0] = r > .8 ? e : t;\n    }\n  }, t.prototype.shouldUpdateRegionsOfInterest = function () {\n    return this.regionsOfInterest.length !== this.maxHandsNumber || this.runsWithoutHandDetector >= this.maxContinuousChecks;\n  }, t;\n}();\n\nfunction R() {\n  return g(this, void 0, void 0, function () {\n    return b(this, function (n) {\n      return \"https://tfhub.dev/mediapipe/tfjs-model/handdetector/1/default/1\", [2, t(\"https://tfhub.dev/mediapipe/tfjs-model/handdetector/1/default/1\", {\n        fromTFHub: !0\n      })];\n    });\n  });\n}\n\nfunction j() {\n  return g(this, void 0, void 0, function () {\n    return b(this, function (n) {\n      return \"https://tfhub.dev/mediapipe/tfjs-model/handskeleton/1/default/1\", [2, t(\"https://tfhub.dev/mediapipe/tfjs-model/handskeleton/1/default/1\", {\n        fromTFHub: !0\n      })];\n    });\n  });\n}\n\nfunction V() {\n  return g(this, void 0, void 0, function () {\n    return b(this, function (t) {\n      return [2, m.fetch(\"https://tfhub.dev/mediapipe/tfjs-model/handskeleton/1/default/1/anchors.json?tfjs-format=file\").then(function (t) {\n        return t.json();\n      })];\n    });\n  });\n}\n\nfunction F(t) {\n  var n = void 0 === t ? {} : t,\n      e = n.maxContinuousChecks,\n      r = void 0 === e ? 1 / 0 : e,\n      o = n.detectionConfidence,\n      i = void 0 === o ? .8 : o,\n      s = n.iouThreshold,\n      a = void 0 === s ? .3 : s,\n      u = n.scoreThreshold,\n      h = void 0 === u ? .5 : u;\n  return g(this, void 0, void 0, function () {\n    var t, n, e, o, s, u;\n    return b(this, function (d) {\n      switch (d.label) {\n        case 0:\n          return [4, Promise.all([V(), R(), j()])];\n\n        case 1:\n          return t = d.sent(), n = t[0], e = t[1], o = t[2], s = new B(e, 256, 256, n, a, h), u = new _(s, o, 256, 256, r, i), [2, new A(u)];\n      }\n    });\n  });\n}\n\nvar A = function () {\n  function t(t) {\n    this.pipeline = t;\n  }\n\n  return t.getAnnotations = function () {\n    return I;\n  }, t.prototype.estimateHands = function (t, n) {\n    return void 0 === n && (n = !1), g(this, void 0, void 0, function () {\n      var e, r, i, s, a, u, h, d, c;\n      return b(this, function (f) {\n        switch (f.label) {\n          case 0:\n            return e = function (t) {\n              return t instanceof v ? [t.shape[0], t.shape[1]] : [t.height, t.width];\n            }(t), r = e[1], i = o(function () {\n              return t instanceof v || (t = P.fromPixels(t)), t.toFloat().expandDims(0);\n            }), [4, this.pipeline.estimateHand(i)];\n\n          case 1:\n            if (s = f.sent(), i.dispose(), null === s) return [2, []];\n\n            for (a = s, !0 === n && (a = function (t, n) {\n              var e = t.handInViewConfidence,\n                  r = t.landmarks,\n                  o = t.boundingBox;\n              return {\n                handInViewConfidence: e,\n                landmarks: r.map(function (t) {\n                  return [n - 1 - t[0], t[1], t[2]];\n                }),\n                boundingBox: {\n                  topLeft: [n - 1 - o.topLeft[0], o.topLeft[1]],\n                  bottomRight: [n - 1 - o.bottomRight[0], o.bottomRight[1]]\n                }\n              };\n            }(s, r)), u = {}, h = 0, d = Object.keys(I); h < d.length; h++) c = d[h], u[c] = I[c].map(function (t) {\n              return a.landmarks[t];\n            });\n\n            return [2, [{\n              handInViewConfidence: a.handInViewConfidence,\n              boundingBox: a.boundingBox,\n              landmarks: a.landmarks,\n              annotations: u\n            }]];\n        }\n      });\n    });\n  }, t;\n}();\n\nexport { A as HandPose, F as load };","map":{"version":3,"sources":["/Users/larrysimiyu/Desktop/codeProjects/handTracking/node_modules/@tensorflow-models/handpose/dist/handpose.esm.js"],"names":["loadGraphModel","t","image","n","tensor2d","e","tensor1d","r","tidy","o","slice","i","add","s","div","a","mul","u","sub","h","concat2d","d","getBackend","c","env","f","sigmoid","l","reshape","p","util","m","Tensor","v","browser","P","g","Promise","next","throw","done","value","then","apply","b","label","sent","trys","ops","return","Symbol","iterator","TypeError","call","pop","length","push","k","Math","abs","endPoint","startPoint","x","y","palmLandmarks","w","max","L","B","model","width","height","iouThreshold","scoreThreshold","anchors","map","x_center","y_center","anchorsTensor","inputSizeTensor","doubleInputSizeTensor","prototype","normalizeBoxes","normalizeLandmarks","getBoundingBoxes","get","set","predict","squeeze","console","warn","nonMaxSuppression","array","forEach","dispose","boxes","estimateHandBounds","shape","resizeBilinear","arraySync","I","thumb","indexFinger","middleFinger","ringFinger","pinky","palmBase","C","PI","atan2","floor","H","M","T","E","O","cos","sin","S","W","z","D","_","regionsOfInterest","runsWithoutHandDetector","boundingBoxDetector","meshDetector","maxContinuousChecks","detectionConfidence","meshWidth","meshHeight","maxHandsNumber","getBoxForPalmLandmarks","concat","calculateLandmarksBoundingBox","getBoxForHandLandmarks","transformRawCoords","estimateHand","shouldUpdateRegionsOfInterest","updateRegionsOfInterest","rotateWithOffset","cropAndResize","dataSync","landmarks","handInViewConfidence","boundingBox","topLeft","bottomRight","min","R","fromTFHub","j","V","fetch","json","F","all","A","pipeline","getAnnotations","estimateHands","fromPixels","toFloat","expandDims","Object","keys","annotations","HandPose","load"],"mappings":"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","sourcesContent":["/**\n    * @license\n    * Copyright 2020 Google LLC. All Rights Reserved.\n    * Licensed under the Apache License, Version 2.0 (the \"License\");\n    * you may not use this file except in compliance with the License.\n    * You may obtain a copy of the License at\n    *\n    * http://www.apache.org/licenses/LICENSE-2.0\n    *\n    * Unless required by applicable law or agreed to in writing, software\n    * distributed under the License is distributed on an \"AS IS\" BASIS,\n    * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n    * See the License for the specific language governing permissions and\n    * limitations under the License.\n    * =============================================================================\n    */\nimport{loadGraphModel as t}from\"@tensorflow/tfjs-converter\";import{image as n,tensor2d as e,tensor1d as r,tidy as o,slice as i,add as s,div as a,mul as u,sub as h,concat2d as d,getBackend as c,env as f,sigmoid as l,reshape as p,util as m,Tensor as v,browser as P}from\"@tensorflow/tfjs-core\";function g(t,n,e,r){return new(e||(e=Promise))((function(o,i){function s(t){try{u(r.next(t))}catch(t){i(t)}}function a(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){var n;t.done?o(t.value):(n=t.value,n instanceof e?n:new e((function(t){t(n)}))).then(s,a)}u((r=r.apply(t,n||[])).next())}))}function b(t,n){var e,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},\"function\"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(e)throw new TypeError(\"Generator is already executing.\");for(;s;)try{if(e=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=n.call(t,s)}catch(t){i=[6,t],r=0}finally{e=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}}function k(t){return[Math.abs(t.endPoint[0]-t.startPoint[0]),Math.abs(t.endPoint[1]-t.startPoint[1])]}function x(t){return[t.startPoint[0]+(t.endPoint[0]-t.startPoint[0])/2,t.startPoint[1]+(t.endPoint[1]-t.startPoint[1])/2]}function y(t,n){void 0===n&&(n=1.5);var e=x(t),r=k(t),o=[n*r[0]/2,n*r[1]/2];return{startPoint:[e[0]-o[0],e[1]-o[1]],endPoint:[e[0]+o[0],e[1]+o[1]],palmLandmarks:t.palmLandmarks}}function w(t){var n=x(t),e=k(t),r=Math.max.apply(Math,e)/2;return{startPoint:[n[0]-r,n[1]-r],endPoint:[n[0]+r,n[1]+r],palmLandmarks:t.palmLandmarks}}function L(t,n){var e=[t.endPoint[0]-t.startPoint[0],t.endPoint[1]-t.startPoint[1]],r=[e[0]*n[0],e[1]*n[1]];return{startPoint:[t.startPoint[0]+r[0],t.startPoint[1]+r[1]],endPoint:[t.endPoint[0]+r[0],t.endPoint[1]+r[1]],palmLandmarks:t.palmLandmarks}}var B=function(){function t(t,n,o,i,s,a){this.model=t,this.width=n,this.height=o,this.iouThreshold=s,this.scoreThreshold=a,this.anchors=i.map((function(t){return[t.x_center,t.y_center]})),this.anchorsTensor=e(this.anchors),this.inputSizeTensor=r([n,o]),this.doubleInputSizeTensor=r([2*n,2*o])}return t.prototype.normalizeBoxes=function(t){var n=this;return o((function(){var e=i(t,[0,0],[-1,2]),r=i(t,[0,2],[-1,2]),o=s(a(e,n.inputSizeTensor),n.anchorsTensor),c=a(r,n.doubleInputSizeTensor),f=u(h(o,c),n.inputSizeTensor),l=u(s(o,c),n.inputSizeTensor);return d([f,l],1)}))},t.prototype.normalizeLandmarks=function(t,n){var e=this;return o((function(){var r=s(a(t.reshape([-1,7,2]),e.inputSizeTensor),e.anchors[n]);return u(r,e.inputSizeTensor)}))},t.prototype.getBoundingBoxes=function(t){return g(this,void 0,void 0,(function(){var e,r,s,a,d,p,m,v,P,g,k,x,y,w,L,B=this;return b(this,(function(b){switch(b.label){case 0:return e=o((function(){return u(h(t,.5),2)})),\"webgl\"===c()?(s=f().get(\"WEBGL_PACK_DEPTHWISECONV\"),f().set(\"WEBGL_PACK_DEPTHWISECONV\",!0),r=this.model.predict(e),f().set(\"WEBGL_PACK_DEPTHWISECONV\",s)):r=this.model.predict(e),a=r.squeeze(),d=o((function(){return l(i(a,[0,0],[-1,1])).squeeze()})),p=i(a,[0,1],[-1,4]),m=this.normalizeBoxes(p),v=console.warn,console.warn=function(){},P=n.nonMaxSuppression(m,d,1,this.iouThreshold,this.scoreThreshold),console.warn=v,[4,P.array()];case 1:return g=b.sent(),k=[e,r,P,a,m,p,d],0===g.length?(k.forEach((function(t){return t.dispose()})),[2,null]):(x=g[0],y=i(m,[x,0],[1,-1]),w=i(a,[x,5],[1,14]),L=o((function(){return B.normalizeLandmarks(w,x).reshape([-1,2])})),k.push(w),k.forEach((function(t){return t.dispose()})),[2,{boxes:y,palmLandmarks:L}])}}))}))},t.prototype.estimateHandBounds=function(t){return g(this,void 0,void 0,(function(){var n,e,r,i,s,a,u,h,d=this;return b(this,(function(c){switch(c.label){case 0:return n=t.shape[1],e=t.shape[2],r=o((function(){return t.resizeBilinear([d.width,d.height]).div(255)})),[4,this.getBoundingBoxes(r)];case 1:return null===(i=c.sent())?(r.dispose(),[2,null]):(s=i.boxes.arraySync(),a=s[0].slice(0,2),u=s[0].slice(2,4),h=i.palmLandmarks.arraySync(),r.dispose(),i.boxes.dispose(),i.palmLandmarks.dispose(),[2,(f={startPoint:a,endPoint:u,palmLandmarks:h},l=[e/this.width,n/this.height],{startPoint:[f.startPoint[0]*l[0],f.startPoint[1]*l[1]],endPoint:[f.endPoint[0]*l[0],f.endPoint[1]*l[1]],palmLandmarks:f.palmLandmarks.map((function(t){return[t[0]*l[0],t[1]*l[1]]}))})])}var f,l}))}))},t}(),I={thumb:[1,2,3,4],indexFinger:[5,6,7,8],middleFinger:[9,10,11,12],ringFinger:[13,14,15,16],pinky:[17,18,19,20],palmBase:[0]};function C(t,n){var e,r=Math.PI/2-Math.atan2(-(n[1]-t[1]),n[0]-t[0]);return(e=r)-2*Math.PI*Math.floor((e+Math.PI)/(2*Math.PI))}var H=function(t,n){return[[1,0,t],[0,1,n],[0,0,1]]};function M(t,n){for(var e=0,r=0;r<t.length;r++)e+=t[r]*n[r];return e}function T(t,n){for(var e=[],r=0;r<t.length;r++)e.push(t[r][n]);return e}function E(t,n){for(var e=[],r=t.length,o=0;o<r;o++){e.push([]);for(var i=0;i<r;i++)e[o].push(M(t[o],T(n,i)))}return e}function O(t,n){var e=Math.cos(t),r=Math.sin(t),o=[[e,-r,0],[r,e,0],[0,0,1]],i=E(H(n[0],n[1]),o);return E(i,H(-n[0],-n[1]))}function S(t,n){return[M(t,n[0]),M(t,n[1])]}var W=[0,-.4],z=[0,-.1],D=[0,5,9,13,17,1,2],_=function(){function t(t,n,e,r,o,i){this.regionsOfInterest=[],this.runsWithoutHandDetector=0,this.boundingBoxDetector=t,this.meshDetector=n,this.maxContinuousChecks=o,this.detectionConfidence=i,this.meshWidth=e,this.meshHeight=r,this.maxHandsNumber=1}return t.prototype.getBoxForPalmLandmarks=function(t,n){var e=t.map((function(t){return S(t.concat([1]),n)}));return y(w(L(this.calculateLandmarksBoundingBox(e),W)),3)},t.prototype.getBoxForHandLandmarks=function(t){for(var n=y(w(L(this.calculateLandmarksBoundingBox(t),z)),1.65),e=[],r=0;r<D.length;r++)e.push(t[D[r]].slice(0,2));return n.palmLandmarks=e,n},t.prototype.transformRawCoords=function(t,n,e,r){var o,i,s,a,u=this,h=k(n),d=[h[0]/this.meshWidth,h[1]/this.meshHeight],c=t.map((function(t){return[d[0]*(t[0]-u.meshWidth/2),d[1]*(t[1]-u.meshHeight/2),t[2]]})),f=O(e,[0,0]),l=c.map((function(t){return S(t,f).concat([t[2]])})),p=(i=[[(o=r)[0][0],o[1][0]],[o[0][1],o[1][1]]],s=[o[0][2],o[1][2]],a=[-M(i[0],s),-M(i[1],s)],[i[0].concat(a[0]),i[1].concat(a[1]),[0,0,1]]),m=x(n).concat([1]),v=[M(m,p[0]),M(m,p[1])];return l.map((function(t){return[t[0]+v[0],t[1]+v[1],t[2]]}))},t.prototype.estimateHand=function(t){return g(this,void 0,void 0,(function(){var e,r,o,i,s,a,u,h,d,l,m,v,P,g,k,y,w,L,B,I;return b(this,(function(b){switch(b.label){case 0:return!0!==(e=this.shouldUpdateRegionsOfInterest())?[3,2]:[4,this.boundingBoxDetector.estimateHandBounds(t)];case 1:return null===(r=b.sent())?(t.dispose(),this.regionsOfInterest=[],[2,null]):(this.updateRegionsOfInterest(r,!0),this.runsWithoutHandDetector=0,[3,3]);case 2:this.runsWithoutHandDetector++,b.label=3;case 3:return o=this.regionsOfInterest[0],i=C(o.palmLandmarks[0],o.palmLandmarks[2]),s=x(o),a=[s[0]/t.shape[2],s[1]/t.shape[1]],u=n.rotateWithOffset(t,i,0,a),h=O(-i,s),d=!0===e?this.getBoxForPalmLandmarks(o.palmLandmarks,h):o,l=function(t,e,r){var o=e.shape[1],i=e.shape[2],s=[[t.startPoint[1]/o,t.startPoint[0]/i,t.endPoint[1]/o,t.endPoint[0]/i]];return n.cropAndResize(e,s,[0],r)}(d,u,[this.meshWidth,this.meshHeight]),m=l.div(255),l.dispose(),u.dispose(),\"webgl\"===c()?(P=f().get(\"WEBGL_PACK_DEPTHWISECONV\"),f().set(\"WEBGL_PACK_DEPTHWISECONV\",!0),v=this.meshDetector.predict(m),f().set(\"WEBGL_PACK_DEPTHWISECONV\",P)):v=this.meshDetector.predict(m),g=v[0],k=v[1],m.dispose(),y=g.dataSync()[0],g.dispose(),y<this.detectionConfidence?(k.dispose(),this.regionsOfInterest=[],[2,null]):(w=p(k,[-1,3]),L=w.arraySync(),k.dispose(),w.dispose(),B=this.transformRawCoords(L,d,i,h),I=this.getBoxForHandLandmarks(B),this.updateRegionsOfInterest(I,!1),[2,{landmarks:B,handInViewConfidence:y,boundingBox:{topLeft:I.startPoint,bottomRight:I.endPoint}}])}}))}))},t.prototype.calculateLandmarksBoundingBox=function(t){var n=t.map((function(t){return t[0]})),e=t.map((function(t){return t[1]}));return{startPoint:[Math.min.apply(Math,n),Math.min.apply(Math,e)],endPoint:[Math.max.apply(Math,n),Math.max.apply(Math,e)]}},t.prototype.updateRegionsOfInterest=function(t,n){if(n)this.regionsOfInterest=[t];else{var e=this.regionsOfInterest[0],r=0;if(null!=e&&null!=e.startPoint){var o=t.startPoint,i=o[0],s=o[1],a=t.endPoint,u=a[0],h=a[1],d=e.startPoint,c=d[0],f=d[1],l=e.endPoint,p=l[0],m=l[1],v=Math.max(i,c),P=Math.max(s,f),g=(Math.min(u,p)-v)*(Math.min(h,m)-P);r=g/((u-i)*(h-s)+(p-c)*(m-s)-g)}this.regionsOfInterest[0]=r>.8?e:t}},t.prototype.shouldUpdateRegionsOfInterest=function(){return this.regionsOfInterest.length!==this.maxHandsNumber||this.runsWithoutHandDetector>=this.maxContinuousChecks},t}();function R(){return g(this,void 0,void 0,(function(){return b(this,(function(n){return\"https://tfhub.dev/mediapipe/tfjs-model/handdetector/1/default/1\",[2,t(\"https://tfhub.dev/mediapipe/tfjs-model/handdetector/1/default/1\",{fromTFHub:!0})]}))}))}function j(){return g(this,void 0,void 0,(function(){return b(this,(function(n){return\"https://tfhub.dev/mediapipe/tfjs-model/handskeleton/1/default/1\",[2,t(\"https://tfhub.dev/mediapipe/tfjs-model/handskeleton/1/default/1\",{fromTFHub:!0})]}))}))}function V(){return g(this,void 0,void 0,(function(){return b(this,(function(t){return[2,m.fetch(\"https://tfhub.dev/mediapipe/tfjs-model/handskeleton/1/default/1/anchors.json?tfjs-format=file\").then((function(t){return t.json()}))]}))}))}function F(t){var n=void 0===t?{}:t,e=n.maxContinuousChecks,r=void 0===e?1/0:e,o=n.detectionConfidence,i=void 0===o?.8:o,s=n.iouThreshold,a=void 0===s?.3:s,u=n.scoreThreshold,h=void 0===u?.5:u;return g(this,void 0,void 0,(function(){var t,n,e,o,s,u;return b(this,(function(d){switch(d.label){case 0:return[4,Promise.all([V(),R(),j()])];case 1:return t=d.sent(),n=t[0],e=t[1],o=t[2],s=new B(e,256,256,n,a,h),u=new _(s,o,256,256,r,i),[2,new A(u)]}}))}))}var A=function(){function t(t){this.pipeline=t}return t.getAnnotations=function(){return I},t.prototype.estimateHands=function(t,n){return void 0===n&&(n=!1),g(this,void 0,void 0,(function(){var e,r,i,s,a,u,h,d,c;return b(this,(function(f){switch(f.label){case 0:return e=function(t){return t instanceof v?[t.shape[0],t.shape[1]]:[t.height,t.width]}(t),r=e[1],i=o((function(){return t instanceof v||(t=P.fromPixels(t)),t.toFloat().expandDims(0)})),[4,this.pipeline.estimateHand(i)];case 1:if(s=f.sent(),i.dispose(),null===s)return[2,[]];for(a=s,!0===n&&(a=function(t,n){var e=t.handInViewConfidence,r=t.landmarks,o=t.boundingBox;return{handInViewConfidence:e,landmarks:r.map((function(t){return[n-1-t[0],t[1],t[2]]})),boundingBox:{topLeft:[n-1-o.topLeft[0],o.topLeft[1]],bottomRight:[n-1-o.bottomRight[0],o.bottomRight[1]]}}}(s,r)),u={},h=0,d=Object.keys(I);h<d.length;h++)c=d[h],u[c]=I[c].map((function(t){return a.landmarks[t]}));return[2,[{handInViewConfidence:a.handInViewConfidence,boundingBox:a.boundingBox,landmarks:a.landmarks,annotations:u}]]}}))}))},t}();export{A as HandPose,F as load};\n"]},"metadata":{},"sourceType":"module"}